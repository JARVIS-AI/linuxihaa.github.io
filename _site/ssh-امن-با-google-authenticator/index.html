<!DOCTYPE HTML>
<html lang="fa">
	<head>
		<title>لینوکسی‌ها - SSH امن با Google Authenticator</title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8" />
		<link rel="alternate" href="http://linuxihaa.ir" hreflang="fa-IR" />
		<link type="application/atom+xml" rel="alternate" href="http://linuxihaa.ir/feed.xml" title="لینوکسی‌ها">
		<link type="application/xml" rel="sitemap" title="لینوکسی‌ها" href="http://linuxihaa.ir/sitemap.xml" />
		<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width, initial-scale=1">
			<!--[if lte IE 8]><script src="/assets/css/ie/html5shiv.js"></script><![endif]-->
		<script src="/assets/js/jquery.min.js"></script>
		<script src="/assets/js/jquery.dropotron.min.js"></script>
		<script src="/assets/js/skel.min.js"></script>
		<script src="/assets/js/skel-layers.min.js"></script>
		<script src="/assets/js/jquery.scrollgress.min.js"></script>
		<script src="/assets/js/init.js?v=2016-07-09:3"></script>
		<noscript>
			<link rel="stylesheet" href="/assets/css/skel.css" />
			<link rel="stylesheet" href="/assets/css/style.css" />
		</noscript>
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/css/ie/v8.css" /><![endif]-->
		<meta name="robots" content="noodp"/>
		<meta name="description" content="امن نمودن SSH با استفاده از Google Authenticator"/>
		<meta property="og:site_name" content="لینوکسی‌ها" />
		<link rel="canonical" href="http://linuxihaa.ir/ssh-%D8%A7%D9%85%D9%86-%D8%A8%D8%A7-google-authenticator/" />
		<meta property="og:locale" content="fa_IR" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="لینوکسی‌ها - SSH امن با Google Authenticator" />
		<meta property="og:description" content="امن نمودن SSH با استفاده از Google Authenticator" />
		<meta property="og:url" content="http://linuxihaa.ir/ssh-%D8%A7%D9%85%D9%86-%D8%A8%D8%A7-google-authenticator/" />
		<meta property="article:tag" content="Google Authenticator" />
		<meta property="article:section" content="آموزشی" />
		<meta property="article:published_time" content="2016-07-23 00:00:00 +0000" />
		
		
		<meta property="og:image" content="http://linuxihaa.ir/assets/images/openssh-two-factor.png" />
		<meta property="og:image:width" content="600" />
		<meta property="og:image:height" content="300" />
	</head>
	
		<body>
			<section id="banner"></section>
	
	<!-- Header -->
	<header id="header" class="alt">
		<div id="logo" ><a href="/"><span>لینوکسی‌ها</span><img src="/logo.png" /></a></div>
		<nav id="nav">
			<ul>
				<li><a href="/">خانه</a></li>
				<li>
					<a href="" class="icon fa-angle-down">دسته‌بندی</a>
					<ul>
						
						<li><a href="/category/خبری/">خبری</a></li>
						
						<li><a href="/category/آموزشی/">آموزشی</a></li>
						
					</ul>
				</li>
				<li><a href="/about/">درباره</a></li>
				<li><a href="/cooperation/">همکاری</a></li>
				<li><a href="/contact/">تماس</a></li>
			</ul>
		</nav>
	</header>

	<!-- Main -->
	<section id="main" class="container">

	<article class="box special">
		<header>
			<h1>SSH امن با Google Authenticator</h1>
		</header>
		<div class="content"><p>یکی از راه‌هایی که می‌توان برای امن نمودن دسترسی ssh به سیستم‌های لینوکسی مخصوصا سرورها انجام داد استفاده از روش تایید ارتباط ۲ مرحله ای یا two-factor authentication است. با استفاده از الگوریتم تولید کلمه عبور یکبار مصرف بر اساس زمان می‌توانیم تأیید اعتبار دسترسی ssh را به‌صورت دو مرحله‌ای انجام دهیم. برای اینکار می‌توانیم از سیستم Google Authenticator استفاده کنیم. به این صورت که پس از ورود با رمز اصلی، یک Verification code از شما درخواست می‌شود که می‌بایست آنرا از روی نرم‌افزار نصب شده روی گوشی موبایلتان وارد کنید.</p>

<p>*نکته)‌ می‌بایست نرم‌افزار Google Authenticator بر روی گوشی موبایلتان نصب باشد. نسخه رسمی این برنامه برای سه پلتفرم IOS, Blackberry و اندروید منتشر شده است.</p>

<p>برای این کار می‌بایست از ماژول Google Authenticator PAM استفاده کنیم. PAM مجموعه‌ای از ماژول‌های داینامیک است که فرایند Authorization را انجام می‌دهند.</p>

<p>برای نصب ماژول Google Authenticator PAM در سیستم‌های 
مبتنی بر دبیان بصورت زیر عمل می‌کنیم.</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>sudo apt-get install libpam-google-authenticator
</code></pre>
</div>
<p>سپس با یوزری که می‌خواهید به‌صورت Remote به سرور دسترسی داشته باشید لاگین نموده و دستور زیر را وارد می‌کنیم.</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>google-authenticator
</code></pre>
</div>

<p>پس از اجرای دستور بالا یک سری سؤالات بصورت Yes/No از شما 
پرسیده می‌شود که به آن‌ها پاسخ مناسب بدهید. سپس برنامه یک QR Code قابل اسکن و Secret Key مخصوص به شما و تعدادی Emergency Code برای شرایط اضطراری را به شما نمایش می‌دهد که می‌بایست Secret Key نمایش داده شده را وارد برنامه Google Authenticator نصب شده بر روی گوشی موبایلتان کنید. همچنین می‌توانید توسط دوربین موبایلتان QR Code نمایش داده شده را اسکن کنید تا بطور خودکار اطلاعات مربوطه در نرم‌افزار ثبت شود.</p>

<p>پس از وارد نمودن اطلاعات فوق برنامه به‌طور مرتب یک شماره ۶ رقمی را برای شما ایجاد می‌کند که این همان Verification code شما خواهد بود.</p>

<p>سپس می بایست ماژول  Google Authenticator PAM را برای سرویس SSH فعال کنیم. برای اینکار به‌صورت زیر عمل می کنیم.</p>

<p>ابتدا فایل etc/pam.d/sshd را ویرایش نموده و خط زیر را به آن اضافه می‌کنیم.</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>auth required pam_google_authenticator.so
</code></pre>
</div>

<p>سپس فایل etc/ssh/sshd_config را ویرایش نموده و خط ChallengeResponseAuthentication را به‌صورت زیر تغییر می‌دهیم.</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>ChallengeResponseAuthentication yes
</code></pre>
</div>

<p>در پایان سرویس ssh را توسط دستور زیر مجدداً راه اندازی می‌کنیم.</p>

<div class="language-sh highlighter-rouge"><pre class="highlight"><code>sudo systemctl restart sshd.service
</code></pre>
</div>

<p>از این پس هنگام ssh نمودن یه سیستم فوق علاوه بر رمز کاربر از شما یک Verification code هم درخواست می‌شود که می‌بایست با مراجعه به نرم‌افزار نصب‌شده روی گوشی، کد تولید شده را وارد نمایید.</p>
</div>
		<footer class="meta">
<!-- AddToAny BEGIN -->
<div class="a2a_kit a2a_kit_size_32 a2a_default_style">
<a class="a2a_dd" href="https://www.addtoany.com/share"></a>
<a class="a2a_button_facebook"></a>
<a class="a2a_button_twitter"></a>
<a class="a2a_button_google_plus"></a>
</div>
<script async src="https://static.addtoany.com/menu/page.js"></script>
<!-- AddToAny END -->
			
			
			
			<span>نوشته شده توسط </span><address class="author"><a href="mailto:r.masoumvand@yahoo.com" class="author" rel="author" target="_blank" title="Linux Ninja">رضا معصوم‌وند</a></address><span>، </span>
			
			
			
			<time class="date" pubdate datetime="2016-07-23T00:00:00+00:00">شنبه 2 مرداد 1395</time>
			</span>
			<ul class="tags">
				<span>دسته </span><a href="/category/آموزشی" class="category">آموزشی</a><span>، </span>
				<span>برچسب</span>
				
				<li><a href="/tag/سرور" class="tag">سرور</a><span>،</span></li>
				
				<li><a href="/tag/حریم‌شخصی" class="tag">حریم‌شخصی</a><span>،</span></li>
				
			</ul>
			<div class="adv">
				
					
					
						
						<a href="mailto:r.masoumvand@yahoo.com" target="_blank"><img src="/adv.png" alt="advertise" /></a>
						
					
					
				
			</div>
		</footer>
	</article>
	<div id="disqus_thread"></div>
<script>
    (function() {
        var d = document, s = d.createElement('script');
        
        s.src = 'https://linuxihaa.disqus.com/embed.js';
        
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>لطفاً برای مشاهده نظرات جاوااسکریپت را روشن کنید <a href="https://disqus.com/?ref_noscript" rel="nofollow">Powered by Disqus.</a></noscript>
		</section>
		<!-- Footer -->
			<footer id="footer">
				<span>برچسب‌ها</span>
				<ul class="tags container">
					
					<li>
						<a href="/tag/پراکسی/" title="1 مطلب" style="font-size: 1.0133333333333334em;">پراکسی</a>
					</li>
					
					<li>
						<a href="/tag/اوبونتو/" title="30 مطلب" style="font-size: 1.4733333333333334em;">اوبونتو</a>
					</li>
					
					<li>
						<a href="/tag/dns/" title="1 مطلب" style="font-size: 1.0133333333333334em;">dns</a>
					</li>
					
					<li>
						<a href="/tag/شخصی‌سازی/" title="6 مطلب" style="font-size: 1.0933333333333333em;">شخصی‌سازی</a>
					</li>
					
					<li>
						<a href="/tag/سرور/" title="9 مطلب" style="font-size: 1.14em;">سرور</a>
					</li>
					
					<li>
						<a href="/tag/دبیان/" title="10 مطلب" style="font-size: 1.1533333333333333em;">دبیان</a>
					</li>
					
					<li>
						<a href="/tag/اوبونتو استدیو/" title="1 مطلب" style="font-size: 1.0133333333333334em;">اوبونتو استدیو</a>
					</li>
					
					<li>
						<a href="/tag/کوبونتو/" title="1 مطلب" style="font-size: 1.0133333333333334em;">کوبونتو</a>
					</li>
					
					<li>
						<a href="/tag/زوبونتو/" title="1 مطلب" style="font-size: 1.0133333333333334em;">زوبونتو</a>
					</li>
					
					<li>
						<a href="/tag/اوبونتو کایلین/" title="1 مطلب" style="font-size: 1.0133333333333334em;">اوبونتو کایلین</a>
					</li>
					
					<li>
						<a href="/tag/لوبونتو/" title="2 مطلب" style="font-size: 1.0266666666666666em;">لوبونتو</a>
					</li>
					
					<li>
						<a href="/tag/اوبونتو گنوم/" title="1 مطلب" style="font-size: 1.0133333333333334em;">اوبونتو گنوم</a>
					</li>
					
					<li>
						<a href="/tag/فدورا/" title="10 مطلب" style="font-size: 1.1533333333333333em;">فدورا</a>
					</li>
					
					<li>
						<a href="/tag/ترمینال/" title="5 مطلب" style="font-size: 1.0733333333333333em;">ترمینال</a>
					</li>
					
					<li>
						<a href="/tag/میزکار/" title="6 مطلب" style="font-size: 1.0933333333333333em;">میزکار</a>
					</li>
					
					<li>
						<a href="/tag/گنوم/" title="3 مطلب" style="font-size: 1.0466666666666666em;">گنوم</a>
					</li>
					
					<li>
						<a href="/tag/یونیتی/" title="2 مطلب" style="font-size: 1.0266666666666666em;">یونیتی</a>
					</li>
					
					<li>
						<a href="/tag/سینامون/" title="2 مطلب" style="font-size: 1.0266666666666666em;">سینامون</a>
					</li>
					
					<li>
						<a href="/tag/kde/" title="2 مطلب" style="font-size: 1.0266666666666666em;">kde</a>
					</li>
					
					<li>
						<a href="/tag/xfce/" title="1 مطلب" style="font-size: 1.0133333333333334em;">xfce</a>
					</li>
					
					<li>
						<a href="/tag/lxde/" title="1 مطلب" style="font-size: 1.0133333333333334em;">lxde</a>
					</li>
					
					<li>
						<a href="/tag/ردهت/" title="7 مطلب" style="font-size: 1.1066666666666667em;">ردهت</a>
					</li>
					
					<li>
						<a href="/tag/centos/" title="6 مطلب" style="font-size: 1.0933333333333333em;">centos</a>
					</li>
					
					<li>
						<a href="/tag/نرم‌افزار/" title="21 مطلب" style="font-size: 1.3333333333333333em;">نرم‌افزار</a>
					</li>
					
					<li>
						<a href="/tag/آرچ‌لینوکس/" title="3 مطلب" style="font-size: 1.0466666666666666em;">آرچ‌لینوکس</a>
					</li>
					
					<li>
						<a href="/tag/اوپن‌سوزه/" title="9 مطلب" style="font-size: 1.14em;">اوپن‌سوزه</a>
					</li>
					
					<li>
						<a href="/tag/پیکربندی/" title="16 مطلب" style="font-size: 1.2533333333333334em;">پیکربندی</a>
					</li>
					
					<li>
						<a href="/tag/مرورگر/" title="2 مطلب" style="font-size: 1.0266666666666666em;">مرورگر</a>
					</li>
					
					<li>
						<a href="/tag/لینوکس مینت/" title="7 مطلب" style="font-size: 1.1066666666666667em;">لینوکس مینت</a>
					</li>
					
					<li>
						<a href="/tag/توسعه/" title="3 مطلب" style="font-size: 1.0466666666666666em;">توسعه</a>
					</li>
					
					<li>
						<a href="/tag/شبکه/" title="5 مطلب" style="font-size: 1.0733333333333333em;">شبکه</a>
					</li>
					
					<li>
						<a href="/tag/مگیا/" title="1 مطلب" style="font-size: 1.0133333333333334em;">مگیا</a>
					</li>
					
					<li>
						<a href="/tag/حریم‌شخصی/" title="5 مطلب" style="font-size: 1.0733333333333333em;">حریم‌شخصی</a>
					</li>
					
					<li>
						<a href="/tag/کتاب/" title="1 مطلب" style="font-size: 1.0133333333333334em;">کتاب</a>
					</li>
					
					<li>
						<a href="/tag/بوت‌لودر/" title="1 مطلب" style="font-size: 1.0133333333333334em;">بوت‌لودر</a>
					</li>
					
					<li>
						<a href="/tag/توزیع/" title="1 مطلب" style="font-size: 1.0133333333333334em;">توزیع</a>
					</li>
					
					<li>
						<a href="/tag/sudo/" title="2 مطلب" style="font-size: 1.0266666666666666em;">sudo</a>
					</li>
					
					<li>
						<a href="/tag/کالی لینوکس/" title="1 مطلب" style="font-size: 1.0133333333333334em;">کالی لینوکس</a>
					</li>
					
					<li>
						<a href="/tag/nixos/" title="1 مطلب" style="font-size: 1.0133333333333334em;">nixos</a>
					</li>
					
					<li>
						<a href="/tag/مدیربسته/" title="1 مطلب" style="font-size: 1.0133333333333334em;">مدیربسته</a>
					</li>
					
					<li>
						<a href="/tag/رسپبری‌پای/" title="1 مطلب" style="font-size: 1.0133333333333334em;">رسپبری‌پای</a>
					</li>
					
					<li>
						<a href="/tag/اندروید/" title="1 مطلب" style="font-size: 1.0133333333333334em;">اندروید</a>
					</li>
					
				</ul>
				<ul class="icons">
					<li><a href="http://facebook.com/linuxihaa" class="icon genericon genericon-facebook" target="_blank">Facebook</a></li>
					<li><a href="https://twitter.com/linuxihaa" class="icon genericon genericon-twitter" target="_blank">Twitter</a></li>
					<li><a href="https://telegram.me/linuxiha" class="icon genericon genericon-telegram" target="_blank">Telegram</a></li>
					<li><a href="https://www.instagram.com/linuxiha" class="icon genericon genericon-instagram" target="_blank">Instagram</a></li>
					<li><a href="https://plus.google.com/109502803142394425024/posts" class="icon genericon genericon-googleplus" target="_blank">Google+</a></li>
					<li><a href="http://www.youtube.com/channel/UCM8_p07cthYziOA96HDdzOg" class="icon genericon genericon-youtube" target="_blank">YouTube</a></li>
					<li><a href="https://github.com/linuxihaa" class="icon genericon genericon-github" target="_blank">Github</a></li>
					<li><a href="/feed.xml" class="icon genericon genericon-feed" target="_blank">RSS Feed</a></li>
				</ul>
				<ul class="copyright">
					<li>&copy; حق نشر ۱۳۹۵-۱۳۹۲ <a href="">لینوکسی‌ها</a>، <a href="/version-history/">نسخه‌ی ۲.۰</a>، تحت مجوز <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/">کرتیو کامنز ۳.۰</a></li>
					<li> پوسته برگرفته از <a href="https://github.com/CloudCannon/Alpha-Jekyll-Theme">Alpha Jekyll Theme</a></li>
				</ul>
			</footer>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44951909-1', 'auto');
  ga('send', 'pageview');

</script>
	</body>
</html>

