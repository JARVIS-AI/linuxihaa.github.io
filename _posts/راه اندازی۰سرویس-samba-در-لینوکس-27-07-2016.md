* * *

layout: post            
jdate: 1395-05-06       
user: rmasoumvand            
title: راه اندازی سرویس Samba در لینوکس  
categories:

*   آموزشی

tags:

*   linux samba server

featured: samba-server-linux.jpg            
keywords:

*   linux samba server  

## description: راه اندازی سرویس Samba در لینوکس

Samba یک ابزار بسیار قدرتمند است که به وسیله آن می‌توان سرویس های اشتراک فایل و پرینتر را برای کلاینت های مایکروسافتی ارائه نمود. علاوه بر این می‌توان از آن به عنوان یک دامین کنترلر در شبکه‌های مبتنی بر Windows Server Domain استفاده نمود. همچنین از نسخه چهارم این نرم‌افزار به بعد امکان پشتیبانی ازActive Directory و دامین های Windows NT فراهم شده است

در این آموزش به نحوه نصب و راه اندازی این سرویس و همچنین به اشتراک گذاشتن منابع توسط سرویس Samba برای کلاینت های مایکروسافتی و لینوکسی خواهیم پرداخت.

برای نصب سرویس دهنده Samba دستور زیر را وارد می‌کنیم
```sh
sudo apt install samba
```
سپس برای اعمال تنظیمات می بایست فایل etc/samba/smb.conf/ را با یک ویرایشگر متنی ویرایش کنیم
```sh
sudo gedit /etc/samba/smb.conf
```
فایل smb.conf دارای بخش‌های مختلفی است که در ادامه به توضییح آن‌ها می‌پردازیم:

[global]: در این بخش پیکربندی کلی و مورد استفاده در تمامی بخش‌ها تعریف می گردد

[share]: یک اشتراک را تعریف می‌کند

[printers]: در این بخش پرینتر های به اشتراک گذاشته تعریف می‌شوند

[homes]: دایرکتوری home کاربران به اشتراک گذاشته می شود.

در داخل هرکدام از این بخش‌ها پارامترهایی وجود دارد که هر پارامتر می‌تواند مقداری مانند true, false, yes, no و یا یک رشته یا مسیر داشته باشد.

در ادامه به توضیح برخی از این پارامتر ها می پردازیم:

-browseable: تعیین می‌کند که اشتراک مورد نظرمان می‌تواند Browse شود و یا خیر

-comment: متن توضیح که در کنار اشتراک یا سرویس نمایش داده می‌شود

-create mask: برای تبدیل مجوز های ویندوز به یونیکس/لینوکس در هنگام ایجاد فایل بکار می‌رود. مقدار پیشفرض برابر 0744 می‌باشد

-directory mask: برای تبدیل مجوزهای ویندوز به یونیکس/لینوکس در هنگام ایجاد دایرکتوری بکار می رود. مقدار پیشفرض برابر 755 می‌باشد

-encrypt passwords: تعیین می‌کند که در هنگام Authentication بین سرویس دهنده و سرویس گیرنده کلمات عبور رمزنگاری شوند یا خیر

-security: این گزینه مشخص می‌کند که کاربران چگونه به سرویس دهنده متصل شده و احراز هویت شوند. مقدار پیشفرض برابر user می‌باشد

-read only: امکان ویرایش فایلها توسط کاربران را مشخص می‌کند

-invalid users: کاربران تعریف شده قادر نخواهند بود به سیستم وارد شوند

-workgroup: تعیین کننده نام شبکه Workgroup می‌باشد

-server string: نام سرویس دهنده را در سیستم‌های سرویس گیرنده مشخص می‌کند

-interfaces: آدرس‌هایی را که مجاز به برقراری ارتباط با سرویس دهنده هستند را مشخص می‌کند

-printable: امکان ارسال چاپ توسط کاربر به سرویس دهنده را مشخص می‌کند

و …

قبل از به اشتراک گذاشتن می بایست کاربرانمان را در سرویس دهنده تعریف نماییم. که می بایست بصورت زیر عمل نماییم:
```sh
sudo smbpasswd -L -a USER NAME
```
که در اینجا USER NAME نام کاربر مورد نظر شماست.

برای به اشتراک گذاشتن یک دایرکتوری بصورت زیر عمل می کنیم:
```sh
[My Share]
 path = /home/reza/my_share
 browseable = yes
 read only = yes
```
در مثال فوق یک دایرکتوری با نام My Share و در مسیر home/reza/my_share/ و با دسترسی فقط خواندنی تعریف نمودیم

سپس سرویس دهنده را با دستور زیر مجدداً راه اندازی می‌کنیم
```sh
systemctl restart samba-ad-dc.service
```
جهت بررسی وضعیت سرویس دهنده و منابع به اشتراک گذاشته شده می‌توانیم از دستور زیر استفاده کنیم
```sh
smbclient -L SERVER
```
که در اینجا SERVER می‌تواند نام و یا آدرس ای پی سرویس دهنده باشد.

* نکته)‌ جهت استفاده از ابزار smbclient می بایست ابتدا انرا توسط دستور زیر بر روی سرویس گیرنده های لینوکسی نصب نمود:
```sh
sudo apt install smbclient
```
جهت ماونت نمودن یک اشتراک می‌توانیم بصورت زیر عمل کنیم**:**
```sh
mount –t cifs //SERVER IP/SHARE /mnt –o username=USER NAME,workgroup=WORKGROUP NAME
```
که در اینجا SERVER IP/SHARE// آدرس اشتراک ما و mnt/ آدرس جایی که می بایست در آنجا ماونت شود و USER NAME نام کاربری و WORKGROUP NAME هم نام گروه کاری شما را مشخص می‌کند

*‌نکته)‌ جهت ماونت کردن فایل سیستمهای Samba نیاز به ابزار cifs-utils داریم که می بایست بر روی سرویس گیرنده های لینوکسی نصب کنیم که برای برای نصب cifs-utils دستور زیر را وارد می‌کنیم:
```sh
sudo apt install cifs-utils
```
